// Generated by IcedCoffeeScript 1.3.3f
(function() {
  var haveNewText, popupSentenceDisplay, root;

  root = typeof exports !== "undefined" && exports !== null ? exports : this;

  root.currentText = '';

  $(document).ready(popupSentenceDisplay = $('<div id="popupSentenceDisplay">dialog content is here</div>'), popupSentenceDisplay.dialog({
    'autoOpen': false,
    'modal': false,
    'title': 'some dialog',
    'show': 'clip',
    'hide': 'clip',
    'position': ['right', 'top'],
    'zIndex': 99,
    'width': '800px'
  }));

  haveNewText = function() {
    console.log(root.currentText);
    $('#popupSentenceDisplay').dialog('open');
    $('#popupSentenceDisplay').text('');
    $('.ui-dialog').css('z-index', 99);
    return root.addSentence(root.currentText, 'zh', $('#popupSentenceDisplay'));
  };

  setInterval(function() {
    var lineNum, parenIndex, parenIndexes, selectedText, x;
    selectedText = $('.note-body').text();
    if (selectedText.indexOf('http://geza') !== -1) {
      selectedText = selectedText.slice(0, selectedText.indexOf('http://geza'));
    }
    parenIndexes = (function() {
      var _i, _len, _ref, _results;
      _ref = ')ï¼‰';
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        x = _ref[_i];
        if (selectedText.indexOf(x) !== -1) _results.push(selectedText.indexOf(x));
      }
      return _results;
    })();
    if (parenIndexes.length > 0) {
      parenIndex = Math.min.apply(Math, parenIndexes);
      lineNum = selectedText.slice(0, parenIndex).trim();
      if (!isNaN(lineNum)) selectedText = selectedText.slice(parenIndex + 1);
    }
    if (selectedText !== root.currentText) {
      root.currentText = selectedText;
      return haveNewText();
    }
  }, 1000);

}).call(this);
